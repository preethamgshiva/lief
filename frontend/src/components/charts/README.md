# Chart Components Documentation

This directory contains comprehensive chart components for the manager dashboard, built with Recharts for data visualization.

## Components Overview

### 1. AttendanceChart
- **Purpose**: Displays daily/weekly attendance trends
- **Features**: Line chart with attendance rate, summary statistics
- **Data**: Date, present count, total staff, attendance rate
- **Props**: `data`, `period`

### 2. HoursWorkedChart
- **Purpose**: Shows staff hours comparison and weekly trends
- **Features**: Bar chart for staff hours, line chart for weekly trends
- **Data**: Staff hours, weekly trends, summary stats
- **Props**: `staffHours`, `weeklyTrends`, `period`

### 3. PunctualityChart
- **Purpose**: Analyzes staff punctuality patterns
- **Features**: Bar chart for daily rates, pie chart for overall status
- **Data**: Daily punctuality rates, late arrivals, average minutes late
- **Props**: `data`, `period`

### 4. DepartmentPerformanceChart
- **Purpose**: Compares department performance metrics
- **Features**: Bar chart for hours, pie chart for distribution, efficiency table
- **Data**: Department hours, staff count, efficiency metrics
- **Props**: `data`, `period`

### 5. RealTimeActivityChart
- **Purpose**: Shows current staff status and recent activity
- **Features**: Pie chart for status, activity feed, live indicators
- **Data**: Staff counts, recent activity, status breakdown
- **Props**: `data`

### 6. ChartDashboard
- **Purpose**: Main dashboard container with all charts
- **Features**: Period selection, auto-refresh, error handling, demo data fallback
- **Props**: `onRefresh` (optional)

## Usage

### Basic Implementation
```tsx
import { ChartDashboard } from '@/components/charts';

export default function ManagerPage() {
  return (
    <div>
      <ChartDashboard />
    </div>
  );
}
```

### Individual Charts
```tsx
import { AttendanceChart, HoursWorkedChart } from '@/components/charts';

export default function CustomDashboard() {
  const attendanceData = [/* your data */];
  const hoursData = { /* your data */ };

  return (
    <div className="grid grid-cols-2 gap-6">
      <AttendanceChart data={attendanceData} period="week" />
      <HoursWorkedChart 
        staffHours={hoursData.staffHours}
        weeklyTrends={hoursData.weeklyTrends}
        period="week"
      />
    </div>
  );
}
```

## Data Structure

### Attendance Data
```typescript
interface AttendanceData {
  date: string;
  present: number;
  total: number;
  attendanceRate: number;
}
```

### Hours Worked Data
```typescript
interface HoursData {
  staffId: string;
  name: string;
  hours: number;
  department?: string;
}

interface WeeklyHoursData {
  week: string;
  totalHours: number;
  averageHours: number;
  staffCount: number;
}
```

### Punctuality Data
```typescript
interface PunctualityData {
  date: string;
  totalArrivals: number;
  lateArrivals: number;
  punctualityRate: number;
  averageMinutesLate: number;
}
```

### Department Performance Data
```typescript
interface DepartmentData {
  department: string;
  totalHours: number;
  staffCount: number;
  averageHours: number;
  efficiency: number;
}
```

### Real-time Activity Data
```typescript
interface RealTimeActivityData {
  totalStaff: number;
  activeStaff: number;
  onBreak: number;
  offDuty: number;
  recentActivity: {
    time: string;
    action: string;
    staffName: string;
    type: 'CLOCK_IN' | 'CLOCK_OUT' | 'BREAK_START' | 'BREAK_END';
  }[];
}
```

## API Integration

The charts automatically fetch data from `/api/staff/analytics` with the `includeCharts=true` parameter. The API returns structured data for all chart types.

### API Parameters
- `period`: 'week' | 'month' | 'year'
- `startDate`: ISO date string
- `endDate`: ISO date string
- `includeCharts`: boolean (true for chart data)

### Fallback Data
If the API fails or returns no data, the system automatically falls back to demo data generated by `DemoDataService`.

## Customization

### Styling
All charts use Tailwind CSS classes and can be customized by modifying the component styles.

### Colors
Chart colors are defined in each component and can be adjusted:
- Primary: Blue (#3B82F6)
- Success: Green (#10B981)
- Warning: Yellow (#F59E0B)
- Danger: Red (#EF4444)

### Responsiveness
Charts are fully responsive using Recharts' `ResponsiveContainer` and will adapt to different screen sizes.

## Performance Features

- **Auto-refresh**: Charts update every 30 seconds
- **Lazy loading**: Data is fetched only when needed
- **Error handling**: Graceful fallback to demo data
- **Loading states**: Smooth loading animations

## Dependencies

- **Recharts**: Chart library for React
- **React**: Component framework
- **TypeScript**: Type safety
- **Tailwind CSS**: Styling

## Browser Support

- Modern browsers (Chrome, Firefox, Safari, Edge)
- IE11+ (with polyfills)
- Mobile responsive

## Troubleshooting

### Charts Not Loading
1. Check browser console for errors
2. Verify API endpoint is accessible
3. Check network tab for failed requests
4. Ensure demo data fallback is working

### Data Not Updating
1. Check auto-refresh interval (30 seconds)
2. Verify API is returning fresh data
3. Check for caching issues

### Performance Issues
1. Reduce chart data points
2. Increase refresh interval
3. Implement data pagination
4. Use React.memo for chart components
